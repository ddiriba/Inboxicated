import requests
import urllib3
import time
import pandas as pd
import json
def getCarrier(number):
    carrier = ''
    returned_status = 429
    returned_text = ''
    
    #too many requests status code
    while returned_status == 429: 
        url = 'https://api.telnyx.com/v1/phone_number/1' + number
        urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)
        request_returned = requests.get(url, verify = False)
        returned_text = request_returned.text
        returned_status = request_returned.status_code
        time.sleep(2) #wait 2 seconds

    print(returned_text)
    print('\n')
    print(returned_status)
    print('\n')

    try:
        data = json.loads(returned_text)
        carrier = str(data["carrier"]["name"])
        return carrier
    except:
        return 'fucky shit'
    
if __name__ == '__main__':
    #clean_up()#run after
    FIND_att =[
        '9512272223',
        '9258996295',
        '9257867802',
        '9168352238',
        '9167068199',
        '9166229228',
        '9165498923',
        '8083935900',
        '7758485743',
        '7758483629',
        '7757712550',
        '7757700774',
        '7757425065',
        '7757376765',
        '7756821290',
        '7756360043',
        '7756227397',
        '7755446882',
        '7755443114',
        '7755301726',
        '7755275781',
        '7755254750',
        '7754703666',
        '7754557166',
        '7754403674',
        '7754377584',
        '7754200588',
        '7754092001',
        '7753911256',
        '7753874371',
        '7753869939',
        '7753869157',
        '7753858091',
        '7753798186',
        '7753784578',
        '7753780034',
        '7753780034',
        '7753575103',
        '7753546068',
        '7753518404',
        '7753515688',
        '7753389027',
        '7753387648',
        '7753369508',
        '7753363674',
        '7753134694',
        '7753037362',
        '7753003733',
        '7752975453',
        '7752917888',
        '7752879344',
        '7752870367',
        '7752508469',
        '7752408328',
        '7752400893',
        '7752329286',
        '7752290369',
        '7752252698',
        '7752230548',
        '7752216631',
        '7752199648',
        '7752179698',
        '7752176699',
        '7752176359',
        '7752036384',
        '7752031545',
        '7752006588',
        '7752003355',
        '7696664798',
        '7198218282',
        '7148581918',
        '7077664225',
        '7029966141',
        '7029856696',
        '7029854087',
        '7029798027',
        '7029172778',
        '7029170063',
        '7029063169',
        '7028828289',
        '7028626175',
        '7028584510',
        '7028088484',
        '7028072482',
        '7028015984',
        '7027931220',
        '7027876851',
        '7027581417',
        '7027556276',
        '7027507800',
        '7027224292',
        '7027155526',
        '7027152951',
        '7026826898',
        '7026774008',
        '7026662356',
        '7026592865',
        '7026307958',
        '7026303223',
        '7026290873',
        '7026109880',
        '7025896719',
        '7025806524',
        '7025804333',
        '7025789444',
        '7025767520',
        '7025457213',
        '7025447858',
        '7025415814',
        '7025414673',
        '7025408733',
        '7025405353',
        '7025381875',
        '7025334544',
        '7025331628',
        '7025331287',
        '7025268231',
        '7025177745',
        '7025170712',
        '7025170619',
        '7025090771',
        '7024931021',
        '7024683614',
        '7024651552',
        '7024489511',
        '7024274649',
        '7024264127',
        '7024172551',
        '7024171385',
        '7024123830',
        '7024099932',
        '7024069162',
        '7024062597',
        '7023542120',
        '7023539785',
        '7023386360',
        '7023281178',
        '7023251560',
        '7023215929',
        '7023086361',
        '7023015213',
        '7023000971',
        '7022835982',
        '7022818485',
        '7022804730',
        '7022753669',
        '7022414710',
        '7022411030',
        '7022389304',
        '7022355890',
        '7022324558',
        '7022190260',
        '7022025552',
        '6508085964',
        '6469341044',
        '6197619104',
        '5599708760',
        '5407297212',
        '5304123403',
        '5304014078',
        '5303078643',
        '5186832600',
        '5102396535',
        '4053505035',
        '3253168123',
        '2097022773',
        '2094712603',
        '2089912103',
        '2088709102',
        '2086081000'
        ]

    all_network_list = []

    carrier_list = []
    for i in FIND_att:
        found_carrier = getCarrier(i)
        all_network_list.append(found_carrier)
        print(found_carrier)

    df = pd.DataFrame(FIND_att)
    df['Network'] = all_network_list
    df.to_csv('allnum.csv')