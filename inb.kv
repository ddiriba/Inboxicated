#:kivy 2.0.0
#:import Clock kivy.clock.Clock
#:import Factory kivy.factory.Factory

# List all the available screens and their ids
WindowManager:
        WelcomeScreen:
                id: welcome
        MainScreen:
                id: main
        RetrieveScreen:
                id: retrieve
        SummonScreen:
                id: summon
        AssignScreen:
                id: assign
        DepositScreen:
                id: deposit
        AddMainKeeperScreen:
                id: addmain
        AddKeeperScreen:
                id: add
        ReportProblemScreen:
                id: problem
        LoadingScreen:
                id: loading
        FaceDetectionScreen:
                id: detect
        FaceRecognitionScreen:
                id: recognize
        FallBackScreen:
                id: fallback
        DrunkDetectionScreen:
                id: drunk_det
        OverrideScreen:
                id: override
        OverridePhoneScreen:
                id: phone
        OpenBoxRetrieve:
                id: open_retrieve
        OpenBoxDeposit:
                id: open_deposit
        OpenBoxOverride:
                id: open_override
        CloseBox:
                id: close_box

<WelcomeScreen>:
        name: 'welcome'
        BoxLayout:
                orientation: 'vertical'
                Image:
                        source: './HelperFiles/inboxicated_logo.png'
                        allow_stretch: False
                Label:
                        text: "Swipe up to begin"
                        color: (0,0,0,1)
                        size_hint_y: 0.05
                        font_size: 18
                        font_name: 'Bang'

<MainScreen>:
        name: 'main'
        BoxLayout:
                orientation: 'horizontal'
                padding: 0, 10, 0, 10
                Button:
                        background_color: '#0047AB'
                        text: "Override opening"
                        size_hint_x: 0.2
                        size_hint_y: 0.1
                        font_size: 18
                        font_name: 'Bang'
                        on_release:
                                app.change_screen("override", "left")
                GridLayout:
                        cols: 2
                        rows: 2
                        size_hint_x: 0.6
                        spacing: 10
                        Button:
                                size: (240,240)
                                background_normal: './HelperFiles/deposit.png'
                                background_down: './HelperFiles/deposit_down.png'
                                border: 30,30,30,30
                                on_release: 
                                        app.change_screen("deposit", "left")
                        Button:
                                size: (240,240)
                                background_normal: './HelperFiles/retrieve.png'
                                background_down: './HelperFiles/retrieve_down.png'
                                border: 30,30,30,30
                                on_release: 
                                        app.change_screen("retrieve", "left")
                        Button:
                                size: (240,240)
                                background_normal: './HelperFiles/assign.png'
                                background_down: './HelperFiles/assign_down.png'
                                border: 30,30,30,30
                                on_release: 
                                        app.change_screen("assign", "left")
                        Button:
                                size: (240,240)
                                background_normal: './HelperFiles/summon.png'
                                background_down: './HelperFiles/summon_down.png'
                                border: 30,30,30,30
                                on_release: 
                                        app.change_screen("summon", "left")
                Button:
                        background_color: '#FF0000'
                        text: "Report a bug" 
                        size_hint_x: 0.2
                        size_hint_y: 0.1
                        font_size: 18
                        font_name: 'Bang' 
                        on_release:
                                app.change_screen("problem", "left")
<RetrieveScreen>:
        name: 'retrieve'
        on_enter: app.change_screen("recognize", "left")

<DepositScreen>:
        name: 'deposit'
        MDBoxLayout:
                orientation: 'horizontal'
                padding: 40
                spacing: 50
                MDLabel:
                        id: deposit_label
                        halign: 'center'
                        text: "Deposit\nKeys"
                        theme_text_color: 'ContrastParentBackground'
                        font_size: 50
                        font_name: 'Bang'
                        pos_hint_y: 0.5
                        padding_y: 15
                MDCard:
                        size_hint: None, None
                        size: 330, 330
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        elevation: 10
                        padding: 25
                        spacing: 25
                        background: "./HelperFiles/blue_back.jpg"
                        orientation: 'vertical'
                        MDLabel:
                                halign: 'center'
                                text: 'Provide Information\nto Deposit Keys'
                                font_name: 'Bang'
                                font_size: 25
                        MDTextFieldRound:
                                input_type: 'number'
                                id: user_phone
                                hint_text: "Phone Number"
                                icon_left: "phone"
                                size_hint_x: None
                                width: 200
                                font_size: 18
                                pos_hint: {"center_x": 0.5}
                                on_focus: app.add_numpad()
                        MDRoundFlatButton:
                                text: "Enter Contact Info"
                                font_size: 12
                                on_release: app.enter_info()
                                pos_hint: {'center_x': 0.5}
                        MDRoundFlatButton:
                                text: "Clear"
                                font_size: 12
                                on_release: app.clear_deposit_info()
                                pos_hint: {'center_x': 0.5}
                MDRaisedButton:
                        text: 'Go Back'
                        font_name: 'Bang'
                        on_release: 
                                app.change_screen("main", "right")
                                app.clear_deposit_info()
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}

<AssignScreen>:
        name: 'assign'
        MDBoxLayout:
                orientation: 'horizontal'
                padding: 40
                spacing: 50
                MDLabel:
                        id: assign_label
                        halign: 'center'
                        text: "Assign\nNew Keeper"
                        font_size: 50
                        font_name: 'Bang'
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                        padding_y: 15
                MDCard:
                        size_hint: None, None
                        size: 330, 330
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        elevation: 10
                        padding: 25
                        spacing: 25
                        orientation: 'vertical'
                        background: "./HelperFiles/blue_back.jpg"
                        MDLabel:
                                id: login_label
                                halign: 'center'
                                text: "Existing Keeper Login"
                                font_name: 'Bang'
                                font_size: 25
                                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                                padding_y: 15
                        MDTextFieldRound:
                                id: keeper_phone
                                hint_text: "Phone Number"
                                icon_left: "phone"
                                size_hint_x: None
                                width: 210
                                font_size: 18
                                pos_hint: {"center_x": 0.5}
                        MDTextFieldRound:
                                id: password
                                hint_text: "6-digit Access Code"
                                icon_left: "key-variant"
                                size_hint_x: None
                                width: 210
                                font_size: 18
                                pos_hint: {"center_x": 0.5}
                                password: True
                        MDRoundFlatButton:
                                text: "Log in"
                                font_size: 12
                                on_release: app.check_login()
                                pos_hint: {'center_x': 0.5}
                        MDRoundFlatButton:
                                text: "Clear"
                                font_size: 12
                                on_release: app.clear_assign_info()
                                pos_hint: {'center_x': 0.5}        
                MDRaisedButton:
                        text: 'Go Back'
                        font_name: 'Bang'
                        on_release: 
                                app.change_screen("main", "right")
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}

<AddMainKeeperScreen>:
        name: 'addmain'
        MDBoxLayout:
                orientation: 'horizontal'
                padding: 40
                spacing: 50
                MDLabel:
                        id: assign_label
                        halign: 'center'
                        text: "Assign\nNew Keeper"
                        font_size: 50
                        font_name: 'Bang'
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                        padding_y: 15
                MDCard:
                        size_hint: None, None
                        size: 330, 400
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        elevation: 10
                        padding: 25
                        spacing: 25
                        orientation: 'vertical'
                        background: "./HelperFiles/blue_back.jpg"
                        MDLabel:
                                text: "Provide Your Information to\nRegister as a New Keeper"
                                halign: 'center'
                                font_size: 25
                                font_name: 'Bang'
                                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                                #padding_y: 15
                        MDTextFieldRound:
                                id: keeper_phone
                                hint_text: "Phone Number"
                                icon_left: "phone"
                                size_hint_x: None
                                width: 210
                                font_size: 18
                                pos_hint: {"center_x": 0.5}

                        MDTextFieldRound:
                                id: password
                                hint_text: "6-digit Access Code"
                                icon_left: "key-variant"
                                size_hint_x: None
                                width: 210
                                font_size: 18
                                pos_hint: {"center_x": 0.5}
                                password: True
                        MDTextFieldRound:
                                id: password_check
                                hint_text: "6-digit Access Code"
                                icon_left: "key-variant"
                                size_hint_x: None
                                width: 210
                                font_size: 18
                                pos_hint: {"center_x": 0.5}
                                password: True
                        MDRoundFlatButton:
                                text: "Submit"
                                font_size: 12
                                on_release: app.add_main_keeper()
                                pos_hint: {'center_x': 0.5}
                        MDRoundFlatButton:
                                text: "Clear"
                                font_size: 12
                                on_release: app.clear_add_main_info()
                                pos_hint: {'center_x': 0.5}        
                MDRaisedButton:
                        text: 'Cancel'
                        font_name: 'Bang'
                        on_release: 
                                app.change_screen("welcome", "down")
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}

<AddKeeperScreen>:
        name: 'add'
        MDBoxLayout:
                orientation: 'horizontal'
                padding: 40
                spacing: 50
                MDLabel:
                        id: assign_label
                        halign: 'center'
                        text: "Assign\nNew Keeper"
                        font_size: 50
                        font_name: 'Bang'
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                        padding_y: 15
                MDCard:
                        size_hint: None, None
                        size: 330, 400
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        elevation: 10
                        padding: 25
                        spacing: 25
                        orientation: 'vertical'
                        background: "./HelperFiles/blue_back.jpg"
                        MDLabel:
                                text: "Provide Your Information to\nRegister as a New Keeper"
                                halign: 'center'
                                font_size: 25
                                font_name: 'Bang'
                                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                                #padding_y: 15
                        MDTextFieldRound:
                                id: keeper_phone
                                hint_text: "Phone Number"
                                icon_left: "phone"
                                size_hint_x: None
                                width: 210
                                font_size: 18
                                pos_hint: {"center_x": 0.5}

                        MDTextFieldRound:
                                id: password
                                hint_text: "6-digit Access Code"
                                icon_left: "key-variant"
                                size_hint_x: None
                                width: 210
                                font_size: 18
                                pos_hint: {"center_x": 0.5}
                                password: True
                        MDTextFieldRound:
                                id: password_check
                                hint_text: "6-digit Access Code"
                                icon_left: "key-variant"
                                size_hint_x: None
                                width: 210
                                font_size: 18
                                pos_hint: {"center_x": 0.5}
                                
                        MDRoundFlatButton:
                                text: "Submit"
                                font_size: 12
                                on_release: app.add_keeper()
                                pos_hint: {'center_x': 0.5}
                        MDRoundFlatButton:
                                text: "Clear"
                                font_size: 12
                                on_release: app.clear_add_info()
                                pos_hint: {'center_x': 0.5}        
                MDRaisedButton:
                        text: 'Cancel'
                        font_name: 'Bang'
                        on_release: 
                                app.change_screen("main", "right")
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                
<ReportProblemScreen>:
        name: 'problem'
        BoxLayout:
                orientation: 'vertical'
                padding: 20
                spacing: 20
                Label:
                        color: (0, 0, 0, 1)
                        text: "Report a Bug"
                        font_name: 'Bang'
                        font_size: 50
                        pos_hint: {'center_x': 0.5, 'center_y': 0.1}
                        size_hint_y: 0.2
                Label:
                        color: (0, 0, 0, 1)
                        text: "What part of Inboxicated is not working?\nPick the closest on from options from a dropdown menu."
                        font_size: 25
                        halign: 'center'
                        pos_hint: {'center_x': 0.5}
                        size_hint_y: 0.2
                        size_hint_x: None
                Spinner:
                        size_hint: None, None
                        size: 400, 70
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                        background_normal: "./HelperFiles/blue.jpg"
                        background_down: "./HelperFiles/blue.jpg"
                        option_cls: Factory.get("MySpinnerOption")
                        text: 'Pick one of the options.'
                        font_size: 25
                        color: '#FFFFFF'
                        values: 'Box does not rotate', 'Lid does not open/close', 'Camera is not working', 'Thermal Camera is not working', 'Cannot register to Inboxicated as a user', 'Cannot register to Inboxicated as a keeper', 'The app freezes', 'Cannot notify the keepers'       
                GridLayout:
                        cols: 2
                        rows: 1
                        size_hint_y: 0.2
                        size_hiny_x: None
                        Button:
                                text: "submit"
                                size: 70, 20
                                pos_hint: {'center_x': 0.3, 'center_y': 0.5}
                                background_normal: "./HelperFiles/blue.jpg"
                                on_release: 
                                        app.send_report()
                        Button:
                                text: "cancel"
                                size: 70, 20
                                pos_hint: {'center_x': 0.7, 'center_y': 0.5}
                                background_normal: "./HelperFiles/blue.jpg"
                                on_release: 
                                        app.change_screen("main", "right")

<LoadingScreen>:
        name: 'loading'
        on_enter: app.clear_deposit_info()
        MDSpinner:
                size_hint: None, None
                size: dp(46), dp(46)
                pos_hint: {'center_x': .5, 'center_y': .5}
                active: True

<RecognizerPopUp>:
        name: 'rec_load'
        auto_dismiss: False
        title: "Face Recognition"
        BoxLayout:
                orientation: 'vertical'
                Label:
                        text: "Recognizing your face. Please wait."
                MDSpinner:
                        #title: "Recognizing your face. Please wait."
                        size_hint: None, None
                        size: dp(46), dp(46)
                        pos_hint: {'center_x': .5, 'center_y': .5}
                        active: True



<FaceDetectionScreen>:
        name: 'detect'
        BoxLayout:
                id: layout
                orientation: 'vertical'
                Label:
                        text: "Look at the Camera"
                        size_hint: (1, .1)
                        halign: 'center'
                        font_size: 18
                BoundingPreview:
                        id: bound 
                        size_hint_y: 0.7
                
                Button:
                        text: "Take Photo"
                        size_hint_x: 0.3
                        size_hint_y: 0.1
                        pos_hint: {'center_x': 0.5}
                        preview: bound
                        on_press:
                                app.take_photo()
                        on_release:
                                app.send_info()
                Button:
                        text: "Cancel"
                        size_hint_x: 0.3
                        size_hint_y: 0.1
                        pos_hint: {'center_x': 0.5}
                        on_release: 
                                app.change_screen("main", "right")

<FaceRecognitionScreen>:
        name: 'recognize'
        BoxLayout:
                orientation: 'vertical'
                padding: 30
                spacing: 10
                Label:
                        text: "Retrieving Keys"
                        font_size: 50
                        size_hint_y: 0.1
                        color: (0,0,0,1)
                        font_name: 'Bang'
                CameraPreview:
                        id: cam
                        size_hint_y: 0.6
                Button:
                        text: "Recognize my face"
                        size_hint_x: 0.3
                        size_hint_y: 0.1
                        pos_hint: {'center_x': 0.5}
                        background_normal: "./HelperFiles/blue.jpg"
                        preview: cam
                        on_release:
                                app.recognize_face()
                Button:
                        text: "Cancel"
                        size_hint_x: 0.3
                        size_hint_y: 0.1
                        pos_hint: {'center_x': 0.5}
                        background_normal: "./HelperFiles/blue.jpg"
                        on_release:
                                app.change_screen("main", "right")    
                                app.reset_message()          
<FallBackScreen>:
        name: 'fallback'
        MDBoxLayout:
                orientation: 'horizontal'
                padding: 40
                spacing: 50
                MDLabel:
                        id: solve_label
                        halign: 'center'
                        text: "Solve\nThis"
                        theme_text_color: 'ContrastParentBackground'
                        font_size: 50
                        font_name: 'Bang'
                        pos_hint_y: 0.5
                        padding_y: 15
                MDCard:
                        size_hint: None, None
                        size: 330, 330
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        elevation: 10
                        padding: 25
                        spacing: 25
                        background: "./HelperFiles/blue_back.jpg"
                        orientation: 'vertical'
                        MDLabel:
                                halign: 'center'
                                text: app.questionString
                                font_size: 25
                        MDTextFieldRound:
                                id: answer
                                hint_text: "Solve for x"
                                size_hint_x: None
                                width: 200
                                font_size: 18
                                pos_hint: {"center_x": 0.5}
                        MDRoundFlatButton:
                                text: "Submit"
                                font_size: 12
                                on_release: app.verifyAnswer()
                                pos_hint: {'center_x': 0.5}
                        MDRoundFlatButton:
                                text: "Clear"
                                font_size: 12
                                on_release: app.clear_fallback_info()
                                pos_hint: {'center_x': 0.5}        
                MDRaisedButton:
                        text: 'Go Back'
                        font_name: 'Bang'
                        on_release: 
                                app.change_screen("recognize", "right")
                                app.clear_fallback_info()
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}

<SummonScreen>:
        name: 'summon'
        MDBoxLayout:
                orientation: 'horizontal'
                padding: 40
                spacing: 30
                MDLabel:
                        id: summon_label
                        halign: 'center'
                        text: "Contact\nthe Keepers"
                        theme_text_color: 'ContrastParentBackground'
                        font_size: 50
                        font_name: 'Bang'
                        size_hint_x: 0.2
                        pos_hint_y: 0.5
                        #padding_y: 15
                MDCard:
                        size_hint: None, None
                        size: 330, 330
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        elevation: 10
                        padding: 25
                        spacing: 25
                        orientation: 'vertical'
                        background: "./HelperFiles/blue_back.jpg"
                        MDLabel:
                                text: "Notify the Keepers"
                                halign: 'center'
                                font_size: 25
                                pos_hint: {'center_x': 0.5, 'center_y': 0.2}
                                size_hint_y: 0.3
                                font_name: 'Bang'
                        MDLabel:
                                text: "Please use the button below to notify the keepers. They will recieve the notification shortly and will come help you solve the issue."
                                halign: 'center'
                                font_size: 18
                                size_hint_x: 0.7
                                background_color: [1, 1, 1, 0.7]
                                pos_hint: {'center_x': 0.5, 'center_y': 0.4}
                        MDRoundFlatButton:
                                text: "Send Push Notification"
                                font_size: 20
                                on_release: app.notify_the_keepers()
                                pos_hint: {'center_x': 0.5, 'center_y': 0.7}            
                MDRaisedButton:
                        text: 'Go Back'
                        font_name: 'Bang'
                        on_release: 
                                app.change_screen("main", "right")
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}

<MySpinnerOption@SpinnerOption>:
        background_color: '#1C63A9' 

<DrunkDetectionScreen>:
        name: 'drunk_det'
        BoxLayout:
                orientation: 'horizontal'
                padding: 10
                spacing: 5
                Label:
                        text: "  Drunk\nDetection"
                        font_name: 'Bang'
                        font_size: 40
                        pos_hint_x: 0.5
                        pos_hint_y: 0.5
                        halign: 'center'
                        size_hint_x: 0.2
                        color: (0,0,0,1)
                ThermalCameraPreview:
                        id: thermal
                        size_hint_x: 0.6
                        size_hint_y: 1.0
                        allow_stretch: True
                        pos_hint_y: 0.3
                        canvas.before:
                                PushMatrix
                                Rotate:
                                        angle: -90
                                        origin: self.center
                        canvas.after:
                                PopMatrix
                BoxLayout:
                        orientation: 'vertical'
                        size_hint_x: 0.2
                        padding: [10, 150]
                        spacing: 10
                        Button:
                                text: "Drunk Detect"
                                size_hint_x: 0.9
                                size_hint_y: 0.1
                                pos_hint: {'center_x': 0.5, 'center_y': 0.4}
                                background_normal: "./HelperFiles/blue.jpg"
                                on_release:
                                        app.take_thermal_photo()
                        Button:
                                text: "Cancel"
                                size_hint_x: 0.9
                                size_hint_y: 0.1
                                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                                background_normal: "./HelperFiles/blue.jpg"
                                on_release:
                                        app.change_screen("main", "right")    
                                        app.reset_message()          
                        Button:
                                text: "Solve Math\nEquation Instead"
                                halign: 'center'
                                size_hint_x: 0.9
                                size_hint_y: 0.1
                                pos_hint: {'center_x': 0.5, 'center_y': 0.6}
                                background_normal: "./HelperFiles/blue.jpg"
                                on_release:
                                        app.change_screen("fallback", "right")

<OverrideScreen>:
        name: 'override'
        MDBoxLayout:
                orientation: 'horizontal'
                padding: 40
                spacing: 50
                MDLabel:
                        id: override_label
                        halign: 'center'
                        text: "Override\nOpening"
                        font_size: 50
                        font_name: 'Bang'
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                        padding_y: 15
                MDCard:
                        size_hint: None, None
                        size: 330, 330
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        elevation: 10
                        padding: 25
                        spacing: 25
                        orientation: 'vertical'
                        background: "./HelperFiles/blue_back.jpg"
                        MDLabel:
                                id: login_label
                                halign: 'center'
                                text: "Please log in with keeper credentials to open the box."
                                font_name: 'Bang'
                                font_size: 25
                                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                                padding_y: 15
                        MDTextFieldRound:
                                id: keeper_phone
                                hint_text: "Phone Number"
                                icon_left: "phone"
                                size_hint_x: None
                                width: 210
                                font_size: 18
                                pos_hint: {"center_x": 0.5}
                        MDTextFieldRound:
                                id: password
                                hint_text: "6-digit Access Code"
                                icon_left: "key-variant"
                                size_hint_x: None
                                width: 210
                                font_size: 18
                                pos_hint: {"center_x": 0.5}
                                password: True
                        MDRoundFlatButton:
                                text: "Log in"
                                font_size: 12
                                on_release: app.check_login_override()
                                pos_hint: {'center_x': 0.5}
                        MDRoundFlatButton:
                                text: "Clear"
                                font_size: 12
                                on_release: app.clear_override_info()
                                pos_hint: {'center_x': 0.5}        
                MDRaisedButton:
                        text: 'Go Back'
                        font_name: 'Bang'
                        on_release: 
                                app.change_screen("main", "right")
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}

<OverridePhoneScreen>:
        name: 'phone'
        MDBoxLayout:
                orientation: 'horizontal'
                padding: 40
                spacing: 50
                MDLabel:
                        id: enter_label
                        halign: 'center'
                        text: "Enter\nPhone Number"
                        font_size: 50
                        font_name: 'Bang'
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                        padding_y: 15
                MDCard:
                        size_hint: None, None
                        size: 330, 330
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        elevation: 10
                        padding: 25
                        spacing: 25
                        orientation: 'vertical'
                        background: "./HelperFiles/blue_back.jpg"
                        MDLabel:
                                id: login_label
                                halign: 'center'
                                text: "Please enter the user's phone number."
                                font_name: 'Bang'
                                font_size: 25
                                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                                padding_y: 15
                        MDTextFieldRound:
                                id: user_phone
                                hint_text: "Phone Number"
                                icon_left: "phone"
                                size_hint_x: None
                                width: 210
                                font_size: 18
                                pos_hint: {"center_x": 0.5}
                        MDRoundFlatButton:
                                text: "Submit"
                                font_size: 12
                                on_release: app.check_override_user_phone()
                                pos_hint: {'center_x': 0.5}
                        MDRoundFlatButton:
                                text: "Clear"
                                font_size: 12
                                on_release: app.clear_override_user_phone_info()
                                pos_hint: {'center_x': 0.5}        
                MDRaisedButton:
                        text: 'Cancel'
                        font_name: 'Bang'
                        on_release: 
                                app.change_screen("main", "right")
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}

<OpenBoxRetrieve>:
        name: 'open_retrieve'
        MDBoxLayout:
                orientation: 'horizontal'
                padding: 40
                spacing: 50
                MDLabel:
                        halign: 'center'
                        text: "Open\nthe Box"
                        font_size: 50
                        font_name: 'Bang'
                        #size_hint_x: 0.2
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                        padding_y: 15
                MDCard:
                        size_hint: None, None
                        size: 330, 330
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        elevation: 10
                        padding: 25
                        spacing: 25
                        #size_hint_x: 0.6
                        orientation: 'vertical'
                        background: "./HelperFiles/blue_back.jpg"
                        MDLabel:
                                id: login_label
                                halign: 'center'
                                text: "Please hit the 'Open the Box' button below to retrieve keys."
                                font_size: 18
                                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                                padding_y: 15
                        MDRoundFlatButton:
                                text: "Open the Box"
                                font_size: 12
                                on_release: app.retrieve()
                                pos_hint: {'center_x': 0.5}       
                MDRaisedButton:
                        text: 'Go Back'
                        font_name: 'Bang'
                        #size_hint_x: 0.2
                        on_release: 
                                app.box_popup()
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}


<OpenBoxDeposit>:
        name: 'open_deposit'
        MDBoxLayout:
                orientation: 'horizontal'
                padding: 40
                spacing: 50
                MDLabel:
                        halign: 'center'
                        text: "Open\nthe Box"
                        font_size: 50
                        font_name: 'Bang'
                        #size_hint_x: 0.2
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                        padding_y: 15
                MDCard:
                        size_hint: None, None
                        size: 330, 330
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        elevation: 10
                        padding: 25
                        spacing: 25
                        #size_hint_x: 0.6
                        orientation: 'vertical'
                        background: "./HelperFiles/blue_back.jpg"
                        MDLabel:
                                id: login_label
                                halign: 'center'
                                text: "Please hit the 'Open the Box' button below to deposit keys."
                                font_size: 18
                                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                                padding_y: 15
                        MDRoundFlatButton:
                                text: "Open the Box"
                                font_size: 12
                                on_release: app.deposit()
                                pos_hint: {'center_x': 0.5}       
                MDRaisedButton:
                        text: 'Go Back'
                        font_name: 'Bang'
                        #size_hint_x: 0.2
                        on_release: 
                                app.box_popup()
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}


<OpenBoxOverride>:
        name: 'open_override'
        MDBoxLayout:
                orientation: 'horizontal'
                padding: 40
                spacing: 50
                MDLabel:
                        halign: 'center'
                        text: "Open\nthe Box"
                        font_size: 50
                        font_name: 'Bang'
                        #size_hint_x: 0.2
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                        padding_y: 15
                MDCard:
                        size_hint: None, None
                        size: 330, 330
                        pos_hint: {"center_x": 0.5, "center_y": 0.5}
                        elevation: 10
                        padding: 25
                        spacing: 25
                        #size_hint_x: 0.6
                        orientation: 'vertical'
                        background: "./HelperFiles/blue_back.jpg"
                        MDLabel:
                                id: login_label
                                halign: 'center'
                                text: "Please hit the 'Open the Box' button below to retrieve keys."
                                font_size: 18
                                pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                                padding_y: 15
                        MDRoundFlatButton:
                                text: "Open the Box"
                                font_size: 12
                                on_release: app.override_phone()
                                pos_hint: {'center_x': 0.5}       
                MDRaisedButton:
                        text: 'Go Back'
                        font_name: 'Bang'
                        #size_hint_x: 0.2
                        on_release: 
                                app.box_popup()
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}


<CloseBox>:
        name: 'close_box'
        MDCard:
                size_hint: None, None
                size: 330, 330
                pos_hint: {"center_x": 0.5, "center_y": 0.5}
                elevation: 10
                padding: 25
                spacing: 25
                orientation: 'vertical'
                background: "./HelperFiles/blue_back.jpg"
                MDLabel:
                        halign: 'center'
                        text: "Close\nthe Box"
                        font_size: 25
                        font_name: 'Bang'
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                        padding_y: 15
                MDLabel:
                        id: login_label
                        halign: 'center'
                        text: "When you're done please click the button below to close the box."
                        font_size: 18
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                        padding_y: 15
                MDRoundFlatButton:
                        text: "Close the Box Now"
                        font_size: 12
                        on_release: app.box_close()
                        pos_hint: {'center_x': 0.5}       

<BoxOpening>:
        orientation: "vertical"
        spacing: "8dp"
        size_hint_y: None
        height: "200dp"
        MDLabel:
                halign: 'center'
                text: "Wait until the box rotates to the correct index and opens the iris lid."
                pos_hint: {'center_x': .5}
        MDSpinner:
                size_hint: None, None
                size: dp(46), dp(46)
                pos_hint: {'center_x': 0.5}
                active: True
